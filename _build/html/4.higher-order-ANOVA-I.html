
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Higher-order ANOVA I: The Additive Model &#8212; Linear Models IV: Model Comparisons and the ANOVA</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=90b7ad94" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4.higher-order-ANOVA-I';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Higher-order ANOVA II: The Full Factorial Model" href="5.higher-order-ANOVA-II.html" />
    <link rel="prev" title="Omnibus Tests and Model Comparisons" href="3.omnibus-tests-model-comps.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models IV: Model Comparisons and the ANOVA - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models IV: Model Comparisons and the ANOVA - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.dummy-variables.html">Dummy Variable Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.oneway-ANOVA.html">One-way ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.omnibus-tests-model-comps.html">Omnibus Tests and Model Comparisons</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Higher-order ANOVA I: The Additive Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.higher-order-ANOVA-II.html">Higher-order ANOVA II: The Full Factorial Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Model-Comparisons-ANOVA" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Model-Comparisons-ANOVA/issues/new?title=Issue%20on%20page%20%2F4.higher-order-ANOVA-I.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4.higher-order-ANOVA-I.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Higher-order ANOVA I: The Additive Model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-higher-order-anova-framework">The Higher-order ANOVA Framework</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#means-tables">Means Tables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cell-means">Cell Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#marginal-means">Marginal Means</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-additive-model">The Additive Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additive-model-example-in-r">Additive Model Example in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-effects">Main Effects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#main-effects-in-r">Main Effects in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="higher-order-anova-i-the-additive-model">
<h1>Higher-order ANOVA I: The Additive Model<a class="headerlink" href="#higher-order-anova-i-the-additive-model" title="Link to this heading">#</a></h1>
<p>In the previous parts of this lesson, we examined the use of models that only contained a <em>single</em> categorical predictor variable. But what about those times when we have <em>multiple</em> categorical predictor variables? This is the domain of the <em>high-order</em> ANOVA model, which we will be exploring in both this part and the final part of this lesson.</p>
<section id="the-higher-order-anova-framework">
<h2>The Higher-order ANOVA Framework<a class="headerlink" href="#the-higher-order-anova-framework" title="Link to this heading">#</a></h2>
<p>To begin with, it is important that we establish some key concepts about factorial experimental designs. This is because many of these concepts directly inform the mechanics of how an ANOVA model works. This is by design, as the ANOVA was originally developed by Fisher as a principled way of analysing data from factorial experiments. As such, we need to understand some key ideas behind experimental design in order to understand the analysis.</p>
<section id="terminology">
<h3>Terminology<a class="headerlink" href="#terminology" title="Link to this heading">#</a></h3>
<p>When we describe ANOVA models, we usually do so with reference to both the number of factors and the number of levels each factor has. For instance, a 1-way ANOVA is so-called because it only has <em>one</em> factor. If there were two factors, we would call it a 2-way ANOVA, and so on. If each factor had 2 levels, we could refer to a 2-way ANOVA more specifically as a <span class="math notranslate nohighlight">\(2 \times 2\)</span> ANOVA. Here, each number represents a factor, with the number itself indicating the number of levels. For instance, if the second factor had 3 levels, we would call it a <span class="math notranslate nohighlight">\(2 \times 3\)</span> ANOVA. In a 3-way ANOVA, if each factor had two levels we could call it a <span class="math notranslate nohighlight">\(2 \times 2 \times 2\)</span> ANOVA. If the second factor had 3 levels and the third had 5 levels it would be a <span class="math notranslate nohighlight">\(2 \times 3 \times 5\)</span> ANOVA, and so on. Hopefully the pattern is clear.</p>
</section>
<section id="means-tables">
<h3>Means Tables<a class="headerlink" href="#means-tables" title="Link to this heading">#</a></h3>
<p>The reason for conceptualising the arrangement of factors and levels in this fashion is that it makes the organisation of the experimental manupulation much clearer. If we think of the experiment in terms of a <em>table</em> then the number of <em>cells</em> is given by the multiplication of the factor levels. The simplest example is a <span class="math notranslate nohighlight">\(2 \times 2\)</span> ANOVA that can be represented using a table with <span class="math notranslate nohighlight">\(2 \times 2 = 4\)</span> cells. Such a table would look like this:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Factor B: Level 1</p></th>
<th class="head"><p>Factor B: Level 2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Factor A: Level 1</strong></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Factor A: Level 2</strong></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>The cells therefore represent the <em>intersection</em> of the factor levels. The data from the experiment is collected from each one of these cells and the differences between the cells correspond to the experimental manipulations. Thus, the entire structure of the experiment can be represented this way.</p>
</section>
<section id="cell-means">
<h3>Cell Means<a class="headerlink" href="#cell-means" title="Link to this heading">#</a></h3>
<p>Conceptualising the experiment as a table also makes it clearer how we can <em>summarise</em> the effects from the experiment. Given that we have data representative of each cell of the design, the simplest approach is simply to average all the data within each cell to produce a <em>cell mean</em>. We can then compare the cell means to assess the magnitude of the effect of each manipulation. The cell means are typically represented by the Greek letter <span class="math notranslate nohighlight">\(\mu\)</span>, with subscripts indexing the specific cell. For instance, <span class="math notranslate nohighlight">\(\mu_{12}\)</span> would indicate the mean of the data collected from Level 1 of Factor A and Level 2 of Factor B (row 1 and column 2 of the means table). The complete picture of cell means in a <span class="math notranslate nohighlight">\(2 \times 2\)</span> design is therefore</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Factor B: Level 1</p></th>
<th class="head"><p>Factor B: Level 2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Factor A: Level 1</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{12}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Factor A: Level 2</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{22}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="marginal-means">
<h3>Marginal Means<a class="headerlink" href="#marginal-means" title="Link to this heading">#</a></h3>
<p>Beyond cell means, we can also derive another form of summary known as <em>marginal means</em>. These are so-called because they are written in the <em>margins</em> of the means table. These types of means concern a specific level of one factor, <em>averaged-over</em> the other factors. For instance, there are two cell means that contain Level 1 of Factor A: <span class="math notranslate nohighlight">\(\mu_{11}\)</span> and <span class="math notranslate nohighlight">\(\mu_{12}\)</span>. The <em>marginal mean</em> for Level 1 of Factor A is therefore <span class="math notranslate nohighlight">\((\mu_{11} + \mu_{12})/2 = \mu_{1.}\)</span>. Here, the dot subscript is shorthand for an index that has been averaged-over. This marginal mean is therefore representative of Level 1 of Factor A, <em>ignoring</em> Factor B. We can see the complete picture of both <em>cell means</em> and <em>marginal means</em> below, where <span class="math notranslate nohighlight">\(\mu\)</span> indicates the <em>grand mean</em>.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Factor B: Level 1</p></th>
<th class="head"><p>Factor B: Level 2</p></th>
<th class="head"><p>Marginal Means of A</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Factor A: Level 1</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{12}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{1.}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Factor A: Level 2</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{22}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{2.}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Marginal Means of B</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{.1}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{.2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>As we go through this section and the next, the relevance of cell means and marginal means will become clearer. For now, it is just important that you understand what these terms mean within the context of a factorial experimental design.</p>
</section>
</section>
<section id="the-additive-model">
<h2>The Additive Model<a class="headerlink" href="#the-additive-model" title="Link to this heading">#</a></h2>
<p>Now that we have addressed terminology, we can turn to how we include <em>multiple</em> factors within a model. Let us start with the simplest approach, which is to simply add another factor to the model equation. In terms of notation, this is a basic extension of what we already known</p>
<div class="math notranslate nohighlight">
\[
y_{ijk} = \mu + \alpha_{i} + \beta_{j} + \epsilon_{ijk},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_{i}\)</span> is the effect associated with Factor A and <span class="math notranslate nohighlight">\(\beta_{j}\)</span> is the effect associated with Factor B. The most basic form of this model would be one that represents a <span class="math notranslate nohighlight">\(2 \times 2\)</span> design, with <span class="math notranslate nohighlight">\(i = 1,2\)</span> and <span class="math notranslate nohighlight">\(j = 1,2\)</span>. We would therefore have 4 cell means and thus 4 unique predicted values formed from:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    \mu_{11} &amp;= \mu + \alpha_{1} + \beta_{1} \\
    \mu_{21} &amp;= \mu + \alpha_{2} + \beta_{1} \\
    \mu_{12} &amp;= \mu + \alpha_{1} + \beta_{2} \\
    \mu_{22} &amp;= \mu + \alpha_{2} + \beta_{2}. 
\end{alignat*}
\end{split}\]</div>
<p>Although probably not immediately obvious, this model assumes that the difference between the levels of each factor is the <em>same</em>, irrespective of the levels of the other factor. In other words, the model assumes a <em>constant</em> difference between the rows or the columns of the means table. For instance, the two differences between the 1st and 2nd levels of Factor A are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
    \mu_{11} - \mu_{21} &amp;= \left(\mu + \alpha_{1} + \beta_{1}\right) - \left(\mu + \alpha_{2} + \beta_{1}\right) &amp;&amp;= \alpha_{1} - \alpha_{2} \quad\text{(effect of A at level 1 of B)} \\
    \mu_{12} - \mu_{22} &amp;= \left(\mu + \alpha_{1} + \beta_{2}\right) - \left(\mu + \alpha_{2} + \beta_{2}\right) &amp;&amp;= \alpha_{1} - \alpha_{2} \quad\text{(effect of A at level 2 of B)}
\end{alignat*}
\end{split}\]</div>
<p>As such, no matter the level of Factor B, the effect of Factor A is always <span class="math notranslate nohighlight">\(\alpha_{1} - \alpha_{2}\)</span>. The same is true across the levels of Factor A, where the effect of Factor B is always <span class="math notranslate nohighlight">\(\beta_{1} - \beta_{2}\)</span>. In other words, this model make the strong assumption that the two factors are entirely <em>independant</em> and do not affect each other in any way. The effects of the factors only <em>add</em> and so this is known as the assumption of <em>additivity</em>.</p>
<p>It is important to recognise that additivity is actually a <em>constraint</em> on the fitting procedure. By specifying the model in this fashion, either least-squares or maximum likelihood will produce estimated means that adhere to additivity. The estimated cell means will therefore have a constant difference between the rows and the columns of the table. However, if the data does not adhere to additivity, the estimated cell means and the sample cell means will be <em>different</em>. The degree to which the model does not fit the actual sample means is therefore indicative of the degree to which the additivity assumption does not hold. We will see this in the example below and will be the starting point for justifying the concept of an <em>interaction</em> a little later.</p>
<div class="tip admonition">
<p class="admonition-title">ANOVA Examples</p>
<p>It can be difficult to conceptualise what an ANOVA model is saying when working in abstract terms such as “Factor A” or <span class="math notranslate nohighlight">\(\mu_{12}\)</span>. Often, it is useful to have a concrete example to drive the point home. For instance, imagine that Factor A is <em>depression diagnosis</em> with two levels: <em>depressed</em> and <em>non-depressed</em>. Now imagine that Factor B is <em>anxiety status</em> with two levels: <em>high-anxiety</em> and <em>low-anxiety</em>. Our <span class="math notranslate nohighlight">\(2 \times 2\)</span> table of means would be</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Depression: Non-depressed</p></th>
<th class="head"><p>Depression: Depressed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Anxiety: Low</strong></p></td>
<td><p>Low-anxiety, Non-depressed</p></td>
<td><p>Low-anxiety, Depressed</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Anxiety: High</strong></p></td>
<td><p>High-anxiety, Non-depressed</p></td>
<td><p>High-anxiety, Depressed</p></td>
</tr>
</tbody>
</table>
</div>
<br>
<p>Remembering that the additive model assumes a <em>constant row difference</em> and a <em>constant column difference</em>, this is the same as assuming that the difference between those with and without depression is the same, irrespective of their anxiety (constant <em>column</em> difference). Similarly, this is the same as assuming that the difference between those with high and low anxiety is the same, irrespective of whether they are depressed (constant <em>row</em> difference). For this particular example, it would seem unlikely that depression and anxiety are two completely independant conditions that do not influence each other in any way.</p>
</div>
<section id="additive-model-example-in-r">
<h3>Additive Model Example in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#additive-model-example-in-r" title="Link to this heading">#</a></h3>
<p>As an example, let us expand our <code class="docutils literal notranslate"><span class="pre">mtcars</span></code> analysis with an addition categorical predictor. Within <code class="docutils literal notranslate"><span class="pre">mtcars</span></code> there already exists a factor called <code class="docutils literal notranslate"><span class="pre">vs</span></code> which indicates whether the engine is V-shaped or straight<a class="footnote-reference brackets" href="#engine-foot" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. This is already coded as a dummy variable, but we will label it so that it is clearer what it means before turning it into a factor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">vs.lab</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="p">))</span><span class="w"> </span>
<span class="n">vs.lab</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;V-shaped&quot;</span>
<span class="n">vs.lab</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;Straight&quot;</span>

<span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">vs.lab</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Straight&quot; &quot;V-shaped&quot;
</pre></div>
</div>
</div>
</div>
<p>We will also work with the simpler version of <code class="docutils literal notranslate"><span class="pre">origin</span></code>, where we only had 2 levels: <code class="docutils literal notranslate"><span class="pre">USA</span></code> and <code class="docutils literal notranslate"><span class="pre">Other</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Other&quot; &quot;USA&quot;  
</pre></div>
</div>
</div>
</div>
<p>Our table of means is therefore</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>VS: Straight</p></th>
<th class="head"><p>VS: V-shaped</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Origin: Other</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{12}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Origin: USA</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{22}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>We can now examine how <code class="docutils literal notranslate"><span class="pre">R</span></code> has coded both <code class="docutils literal notranslate"><span class="pre">vs</span></code> and <code class="docutils literal notranslate"><span class="pre">origin</span></code> as dummy variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">contrasts</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">contrasts</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      USA
Other   0
USA     1
         V-shaped
Straight        0
V-shaped        1
</pre></div>
</div>
</div>
</div>
<p>So there are now 4 unique combinations of dummy values that lead to the 4 cell means</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
    \mu_{11} &amp;= \beta_{0} + (\beta_{1} \times \mathbf{0}) + (\beta_{2} \times \mathbf{0}) = \beta_{0} &amp;&amp;\quad\texttt{(Other,Straight)} \\
    \mu_{21} &amp;= \beta_{0} + (\beta_{1} \times \mathbf{1}) + (\beta_{2} \times \mathbf{0}) = \beta_{0} + \beta_{1} &amp;&amp;\quad\texttt{(USA,Straight)} \\
    \mu_{12} &amp;= \beta_{0} + (\beta_{1} \times \mathbf{0}) + (\beta_{2} \times \mathbf{1}) = \beta_{0} + \beta_{2} &amp;&amp;\quad\texttt{(Other,V-shaped)} \\
    \mu_{22} &amp;= \beta_{0} + \underbrace{(\beta_{1} \times \mathbf{1})}_{\texttt{origin}} + \underbrace{(\beta_{2} \times \mathbf{1})}_{\texttt{vs}} = \beta_{0} + \beta_{1} + \beta_{2} &amp;&amp;\quad\texttt{(USA,V-shaped)}\\
\end{alignat*}
\end{split}\]</div>
<p>Using the same logic we used in the previous part of this lesson, we can work out that</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_{0}\)</span></p></td>
<td><p>Mean of <code class="docutils literal notranslate"><span class="pre">(Other,Straight)</span></code> cell</p></td>
<td><p>Reference cell</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_{1}\)</span></p></td>
<td><p>Mean difference <code class="docutils literal notranslate"><span class="pre">(USA,Straight)</span> <span class="pre">-</span> <span class="pre">(Other,Straight)</span></code></p></td>
<td><p>Constant <em>column</em> effect</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_{2}\)</span></p></td>
<td><p>Mean difference <code class="docutils literal notranslate"><span class="pre">(Other,V-shaped)</span> <span class="pre">-</span> <span class="pre">(Other,Straight)</span></code></p></td>
<td><p>Constant <em>row</em> effect</p></td>
</tr>
</tbody>
</table>
</div>
<p>This also helps make sense of how the model prediction works. Thinking of the means table, if we start at the reference cell (<span class="math notranslate nohighlight">\(\mu_{11} = \beta_{0}\)</span>) and then add the <em>row effect</em> (<span class="math notranslate nohighlight">\(\beta_{1}\)</span>) we move <em>down</em> a row and end up at <span class="math notranslate nohighlight">\(\mu_{21}\)</span>. Instead, if we start at the reference cell (<span class="math notranslate nohighlight">\(\mu_{11} = \beta_{0}\)</span>) and then add the <em>column effect</em> (<span class="math notranslate nohighlight">\(\beta_{2}\)</span>) we move <em>across</em> a column and end up at <span class="math notranslate nohighlight">\(\mu_{12}\)</span>. Finally, if we start at the reference cell (<span class="math notranslate nohighlight">\(\mu_{11} = \beta_{0}\)</span>) and then add the <em>row effect</em> (<span class="math notranslate nohighlight">\(\beta_{1}\)</span>) and the <em>column effect</em> (<span class="math notranslate nohighlight">\(\beta_{2}\)</span>) we move down a row and across a column and end up at <span class="math notranslate nohighlight">\(\mu_{22}\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The ability to parameterise the cell means in this way only works because of the <em>additive assumptions</em> about contant row and column effects. If the cell means did not adhere to this, you could not move up/down or left/right across the table of means freely, because the row/column effects would change depending upon which cell you started in. Under the additive model, it does not matter where you start because the differences are always the same.</p>
</div>
<p>Given all this, we can now see how <code class="docutils literal notranslate"><span class="pre">R</span></code> fits this model and check that it aligns with our understanding</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">add.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">origin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">summary</span><span class="p">(</span><span class="n">add.mod</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ origin + vs, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.7035 -3.2079  0.1795  1.9298  8.3965 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   25.504      1.157  22.036  &lt; 2e-16 ***
originUSA     -4.416      1.587  -2.783  0.00939 ** 
vsV-shaped    -6.433      1.571  -4.094  0.00031 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.139 on 29 degrees of freedom
Multiple R-squared:  0.5588,	Adjusted R-squared:  0.5283 
F-statistic: 18.36 on 2 and 29 DF,  p-value: 7.044e-06
</pre></div>
</div>
</div>
</div>
<p>These estimates certainly look like the values we determined in the table above, with the intercept giving us a <em>cell mean</em> and the two slope parameters giving us <em>mean differences</em>. Based on this, we can construct the estimated cell means from the estimated parameters</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">add.mod</span><span class="p">)</span>

<span class="c1"># fitted cell means</span>
<span class="n">mu.other.str</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="n">mu.USA.str</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="n">mu.other.v</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="p">]</span>
<span class="n">mu.USA.v</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="p">]</span>

<span class="c1"># means table</span>
<span class="n">est.means.tbl</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;origin.other&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.other.str</span><span class="p">,</span><span class="n">mu.other.v</span><span class="p">),</span>
<span class="w">                            </span><span class="s">&quot;origin.USA&quot;</span><span class="w">  </span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.USA.str</span><span class="p">,</span><span class="w">  </span><span class="n">mu.USA.v</span><span class="p">),</span>
<span class="w">                            </span><span class="n">row.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;vs.straight&quot;</span><span class="p">,</span><span class="s">&quot;vs.vshaped&quot;</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">est.means.tbl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            origin.other origin.USA
vs.straight     25.50350   21.08716
vs.vshaped      19.07019   14.65385
</pre></div>
</div>
</div>
</div>
<p>As expected, these fitted cell means have a constant difference between each row<a class="footnote-reference brackets" href="#unname-foot" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">unname</span><span class="p">(</span><span class="n">mu.other.str</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.other.v</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">unname</span><span class="p">(</span><span class="n">mu.USA.str</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">mu.USA.v</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 6.433314
[1] 6.433314
</pre></div>
</div>
</div>
</div>
<p>and a constant difference between each column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">unname</span><span class="p">(</span><span class="n">mu.other.str</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.USA.str</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">unname</span><span class="p">(</span><span class="n">mu.other.v</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">mu.USA.v</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 4.416336
[1] 4.416336
</pre></div>
</div>
</div>
</div>
<p>However, these estimated means do not match the actual sample means</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample cell means</span>
<span class="n">mu.other.str</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Other&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Straight&quot;</span><span class="p">])</span>
<span class="n">mu.USA.str</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;USA&quot;</span><span class="w">   </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Straight&quot;</span><span class="p">])</span>
<span class="n">mu.other.v</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Other&quot;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;V-shaped&quot;</span><span class="p">])</span>
<span class="n">mu.USA.v</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;USA&quot;</span><span class="w">   </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">vs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;V-shaped&quot;</span><span class="p">])</span>

<span class="c1"># means table</span>
<span class="n">samp.means.tbl</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;origin.other&quot;</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.other.str</span><span class="p">,</span><span class="w"> </span><span class="n">mu.other.v</span><span class="p">),</span>
<span class="w">                             </span><span class="s">&quot;origin.USA&quot;</span><span class="w">  </span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.USA.str</span><span class="p">,</span><span class="w">   </span><span class="n">mu.USA.v</span><span class="p">),</span><span class="w">  </span>
<span class="w">                             </span><span class="n">row.names</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;vs.straight&quot;</span><span class="p">,</span><span class="s">&quot;vs.vshaped&quot;</span><span class="p">))</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Sample means:\n&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># allows more control over printing than print()</span>
<span class="nf">print</span><span class="p">(</span><span class="n">samp.means.tbl</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\nEstimated means:\n&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">est.means.tbl</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample means:
            origin.other origin.USA
vs.straight     25.59091   20.76667
vs.vshaped      18.95000   14.75000

Estimated means:
            origin.other origin.USA
vs.straight     25.50350   21.08716
vs.vshaped      19.07019   14.65385
</pre></div>
</div>
</div>
</div>
<p>Now, the estimates and the true means are not too far off, so there are a few possibilities here. Firstly, it could be that the assumptions of the additive model do not hold in this example. Alternatively, it is possible that these effects are truly additive in the population and any deviation is simply sampling noise. Or, it could be that the degree to which these two factors influence each other is very minor and that we could treat these factors as additive for the sake of simplicity. We will come back to this when we explore the Full Factorial model in the next part of the lesson.</p>
</section>
<section id="main-effects">
<h3>Main Effects<a class="headerlink" href="#main-effects" title="Link to this heading">#</a></h3>
<p>In the previous part of this lesson, we discussed the concept of an <em>omnibus test</em> as an overall reflection of whether any of the mean differences across the levels of a categorical predictor are non-zero. This idea carries-over into higher-order ANOVA models. The main difference is that our null models are rarely intercept-only. Instead, we include all other factors in the null model <em>except</em> the factor of interest. The logic is that the additional factors may relate to the outcome variable and thus should be included in the null model. This is so that the error is as accurate as possible and does not accidentally contain any sources of systematic variation which would make it larger than it should be. Another way of thinking about this is that the omnibus null for one variable is not based on assuming that there are <em>no relationships with any other variables</em>. As such, the null model simply involves removing a <em>single variable</em>, not all of them<a class="footnote-reference brackets" href="#reganova-foot" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<div class="tip admonition">
<p class="admonition-title">Main Effects Definition</p>
<p>Within the context of an ANOVA, the omnibus effect of a single categorical predictor is known as a <em>main effect</em>. Under additivity, this reflects the omnibus effect of a single factor, ignoring all other factors in the model. For instance, what is the effect of <code class="docutils literal notranslate"><span class="pre">origin</span></code>, irrespective of whether an engine is <code class="docutils literal notranslate"><span class="pre">straight</span></code> or <code class="docutils literal notranslate"><span class="pre">v-sahped</span></code>? Or, what is the effect of <em>depression</em>, irrespective of whether someone is <em>highly-anxious</em> or not? Main effects <em>require</em> additivity to be interpretable and are based on comparing <em>marginal means</em> for the factor of interest.</p>
</div>
<p>Based on everything above, the <em>main effect</em> of Factor A is equivalent to the following model comparison</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
    \mathcal{M}_{0} &amp;: y_{jk}  &amp;&amp;= \mu + \beta_{j} + \epsilon_{jk} \\
    \mathcal{M}_{1} &amp;: y_{ijk} &amp;&amp;= \mu + \alpha_{i} + \beta_{j} + \epsilon_{ijk},
\end{alignat*}
\end{split}\]</div>
<p>and the main effect of Factor B is equivalent to the following model comparison</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
    \mathcal{M}_{0} &amp;: y_{ik}  &amp;&amp;= \mu + \alpha_{i} + \epsilon_{ik} \\
    \mathcal{M}_{1} &amp;: y_{ijk} &amp;&amp;= \mu + \alpha_{i} + \beta_{j} + \epsilon_{ijk}.
\end{alignat*}
\end{split}\]</div>
<p>In each case, we simply remove the terms associated with the factor of interest and see whether the change in the residual sums-of-squares is large relative to the error. This is then equivalent to comparing all the <em>marginal means</em> associated with a single factor. In the case of a <span class="math notranslate nohighlight">\(2 \times 2\)</span> design, the omnibus null for these factors would be</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    \mathcal{H}_{0} &amp;: \mu_{1.} = \mu_{2.} \quad\text{(Main effect of Factor A)} \\
    \mathcal{H}_{0} &amp;: \mu_{.1} = \mu_{.2} \quad\text{(Main effect of Factor B)}. \\
\end{alignat*}
\end{split}\]</div>
<p>Although both these hypotheses only involve two means, they still remain dissimilar to a <span class="math notranslate nohighlight">\(t\)</span>-test by virtue of taking the <em>other factor</em> into account. This is not something you can do with a simple <span class="math notranslate nohighlight">\(t\)</span>-test. Of course, when dealing with factors that contain <span class="math notranslate nohighlight">\(&gt; 2\)</span> levels, the need for an omnibus test becomes even clearer.</p>
<section id="main-effects-in-r">
<h4>Main Effects in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#main-effects-in-r" title="Link to this heading">#</a></h4>
<p>As we saw previously, we can form omnibus tests from explicit model comparisons using the <code class="docutils literal notranslate"><span class="pre">anova()</span></code> function. Using this method, the main effect of <code class="docutils literal notranslate"><span class="pre">origin</span></code> would be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">null.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">vs</span><span class="p">,</span><span class="w">          </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">full.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">origin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">anova</span><span class="p">(</span><span class="n">null.mod</span><span class="p">,</span><span class="n">full.mod</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis of Variance Table

Model 1: mpg ~ vs
Model 2: mpg ~ origin + vs
  Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
1     30 629.52                                
2     29 496.86  1    132.66 7.7428 0.009386 **
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>and the main effect of <code class="docutils literal notranslate"><span class="pre">vs</span></code> would be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">null.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">origin</span><span class="p">,</span><span class="w">      </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">full.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">origin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">anova</span><span class="p">(</span><span class="n">null.mod</span><span class="p">,</span><span class="n">full.mod</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis of Variance Table

Model 1: mpg ~ origin
Model 2: mpg ~ origin + vs
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     30 784.06                                  
2     29 496.86  1     287.2 16.763 0.0003096 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Or, more practically, we can simply give the full model to the <code class="docutils literal notranslate"><span class="pre">Anova()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">car</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">Anova</span><span class="p">(</span><span class="n">add.mod</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: carData
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Anova Table (Type II tests)

Response: mpg
          Sum Sq Df F value    Pr(&gt;F)    
origin    132.66  1  7.7428 0.0093864 ** 
vs        287.20  1 16.7628 0.0003096 ***
Residuals 496.86 29                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Compare the <code class="docutils literal notranslate"><span class="pre">Anova()</span></code> output with the outputs from the model comparisons to reassure yourself that these are <em>identical</em>.</p>
<p>Based on this result, there are significant differences in <code class="docutils literal notranslate"><span class="pre">mpg</span></code> between the levels of both <code class="docutils literal notranslate"><span class="pre">origin</span></code> and <code class="docutils literal notranslate"><span class="pre">vs</span></code>, assuming the two factors have independent influences on <code class="docutils literal notranslate"><span class="pre">mpg</span></code>. In context, this is assuming that there is nothing about where the car is manufactured that influences the shape of the engine, nor anything about the shape of the engine that influences where it was manufactured. Based on this, we would conclude that <em>both</em> the engine shape and the country of origin independently influence MPG.</p>
<aside class="topic">
<p class="topic-title">What do you now know?</p>
<p>In this section, we have explored higher-order ANOVA models in terms of a simple additive model. After reading this section, you should have a good sense of:</p>
<ul class="simple">
<li><p>The difference between <em>cell means</em>, <em>marginal means</em> and how these correspond to a factorial experimental design.</p></li>
<li><p>The concept of the <em>means table</em> as a way of summarising an experimental manipulation.</p></li>
<li><p>The model form of a simple 2-way ANOVA and how this differs from a 1-way ANOVA.</p></li>
<li><p>The idea of assuming <em>additivity</em> in terms of a constant row and column difference between the cell means.</p></li>
<li><p>How multiple factors can be coded as dummy variables and what this implies about the meaning of the parameters.</p></li>
<li><p>What a <em>main effect</em> is and how it can be constructed using model comparisons.</p></li>
</ul>
</aside>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="engine-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Not that it really matters for understanding an ANOVA, but a straight engine has cylinders in a straight line, while a V-shaped engine has two banks of cylinders arranged in a “V”. V-shaped engines tend to be more compact and powerful. Straight engines are often more balanced, whereas V engines are shorter and can be better for performance-focused applications.</p>
</aside>
<aside class="footnote brackets" id="unname-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>All the <code class="docutils literal notranslate"><span class="pre">unname()</span></code> function is doing here is preventing <code class="docutils literal notranslate"><span class="pre">R</span></code> from printing any labels alongside these results and making them less clear. Sometimes, values carry labels with them across different calculations and you get some odd names, like <code class="docutils literal notranslate"><span class="pre">(Intercept)</span></code> being printed above the calculations. This stops that from happening. You can remove it, if you like, and see what happens.</p>
</aside>
<aside class="footnote brackets" id="reganova-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>If we want to remove <em>everything</em>, we can always use the regression ANOVA report at the bottom of the summary table, as mentioned at the end of the previous part of the lesson.</p>
</aside>
</aside>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.omnibus-tests-model-comps.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Omnibus Tests and Model Comparisons</p>
      </div>
    </a>
    <a class="right-next"
       href="5.higher-order-ANOVA-II.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Higher-order ANOVA II: The Full Factorial Model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-higher-order-anova-framework">The Higher-order ANOVA Framework</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#means-tables">Means Tables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cell-means">Cell Means</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#marginal-means">Marginal Means</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-additive-model">The Additive Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additive-model-example-in-r">Additive Model Example in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-effects">Main Effects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#main-effects-in-r">Main Effects in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar & Dr George Farmer
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025-26.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>