
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>One-way ANOVA &#8212; Linear Models IV: Model Comparisons and the ANOVA</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=90b7ad94" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '2.oneway-ANOVA';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models IV: Model Comparisons and the ANOVA - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models IV: Model Comparisons and the ANOVA - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.dummy-variables.html">Dummy Variable Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.oneway-ANOVA-alt.html">One-way ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.omnibus-tests-model-comps-alt.html">Omnibus Tests and Model Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.higher-order-ANOVA.html">Higher-order ANOVA Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.follow-up.html">Follow-up Tests and Visualisations</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Model-Comparisons-ANOVA" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63101-Advanced-Data-Skills/Model-Comparisons-ANOVA/issues/new?title=Issue%20on%20page%20%2F2.oneway-ANOVA.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/2.oneway-ANOVA.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>One-way ANOVA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-way-anova-as-a-linear-model">One-way ANOVA as a Linear Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-dummy-variable-regression-to-the-linear-model">Connecting Dummy Variable Regression to the Linear Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-variables-coding-2-levels">Dummy Variables Coding &gt; 2 Levels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-in-r">Example in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="one-way-anova">
<h1>One-way ANOVA<a class="headerlink" href="#one-way-anova" title="Link to this heading">#</a></h1>
<p>In the previous section, we saw how dummy variables can be incorporated into a regression model to represent a categorical predictor. We also saw how this can produce <em>identical</em> results to a traditional <span class="math notranslate nohighlight">\(t\)</span>-test. Now it is time to take this further and see how dummy variable regression can also be equivalent to a traditional Analysis of Variance (ANOVA). The starting point for this is the basic <em>One-way ANOVA</em>, where we have a <em>single</em> categorical predictor with <span class="math notranslate nohighlight">\(&gt; 2\)</span> levels. As we will see, this is simply a generalisation of the <span class="math notranslate nohighlight">\(t\)</span>-test we saw in the previous part of this lesson.</p>
<section id="one-way-anova-as-a-linear-model">
<h2>One-way ANOVA as a Linear Model<a class="headerlink" href="#one-way-anova-as-a-linear-model" title="Link to this heading">#</a></h2>
<p>When you think of an ANOVA, you may be more used to thinking of an ANOVA <em>table</em>, like the one shown below</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Source</p></th>
<th class="head"><p>df</p></th>
<th class="head"><p>SS</p></th>
<th class="head"><p>MS</p></th>
<th class="head"><p>F</p></th>
<th class="head"><p>p-value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Between Groups</p></td>
<td><p>2</p></td>
<td><p>24.67</p></td>
<td><p>12.33</p></td>
<td><p>5.21</p></td>
<td><p>0.012</p></td>
</tr>
<tr class="row-odd"><td><p>Within Groups</p></td>
<td><p>27</p></td>
<td><p>63.83</p></td>
<td><p>2.36</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p>29</p></td>
<td><p>88.50</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>However, in reality, it is more accurate to think of an ANOVA as a very basic <em>linear model</em>. The ANOVA table is a convenient way to organise the arithmetic of hypothesis tests, but the table is <em>not</em> the model itself. Traditional statistical education in Psychology tends to skip the actual model and go straight to the hypothesis tests. This is not what we are going to do. Instead, we will ignore the ANOVA table for the moment and start by focusing on the <em>true form</em> of the ANOVA as a very basic linear model of <em>group means</em>.</p>
<p>In the case of a One-way ANOVA, there is only a <em>single</em> categorical predictor with a certain number of levels. The linear model at the heart of the ANOVA is then</p>
<div class="math notranslate nohighlight">
\[
y_{ij} \sim \mathcal{N}\left(\mu_{j},\sigma^{2}\right).
\]</div>
<p>Or, equivalently,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y_{ij} &amp;= \mu_{j} + \epsilon_{ij} \\
    \epsilon_{ij} &amp;\sim \mathcal{N}\left(0,\sigma^{2}\right),
\end{align*}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_{j}\)</span> is simply the <em>group mean</em> for level <span class="math notranslate nohighlight">\(j\)</span> of the predictor. For instance, say our categorical predictor had 3 levels (<span class="math notranslate nohighlight">\(j = 1,2,3\)</span>). The <span class="math notranslate nohighlight">\(i\)</span> th observation from the first level would be denoted <span class="math notranslate nohighlight">\(y_{i1}\)</span>, the <span class="math notranslate nohighlight">\(i\)</span> th observation from the second level would be denoted <span class="math notranslate nohighlight">\(y_{i2}\)</span> and the <span class="math notranslate nohighlight">\(i\)</span> th observation from the third level would be denoted <span class="math notranslate nohighlight">\(y_{i3}\)</span>. As such, this implies that there are 3 unique model predictions, one for each level of the categorical predictor. So, when <span class="math notranslate nohighlight">\(j = 1,2,3\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y_{i1} &amp;= \mu_{1} + \epsilon_{i1} \\
    y_{i2} &amp;= \mu_{2} + \epsilon_{i2} \\
    y_{i3} &amp;= \mu_{3} + \epsilon_{i3}
\end{align*}
\end{split}\]</div>
<p>This makes the model <em>very simple</em>. Every data point has a predicted value that is equal to the mean of the group that data point belongs to. The errors then reflect the differences between the group means and the raw data. To make this even clearer, if we say that there are 4 data point per-group then <span class="math notranslate nohighlight">\(i = 1,2,3,4\)</span> and the model for the whole dataset is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
&amp;\text{Group 1} \begin{cases}
        y_{11} &amp;= \mu_{1} + \epsilon_{11} \\
        y_{21} &amp;= \mu_{1} + \epsilon_{21} \\
        y_{31} &amp;= \mu_{1} + \epsilon_{31} \\
        y_{41} &amp;= \mu_{1} + \epsilon_{41} \\
\end{cases} \\
&amp;\text{Group 2} \begin{cases}
        y_{12} &amp;= \mu_{2} + \epsilon_{12} \\
        y_{22} &amp;= \mu_{2} + \epsilon_{22} \\
        y_{32} &amp;= \mu_{2} + \epsilon_{32} \\
        y_{42} &amp;= \mu_{2} + \epsilon_{42} \\
\end{cases} \\
&amp;\text{Group 3} \begin{cases}
        y_{13} &amp;= \mu_{3} + \epsilon_{13} \\
        y_{23} &amp;= \mu_{3} + \epsilon_{23} \\
        y_{33} &amp;= \mu_{3} + \epsilon_{33} \\
        y_{43} &amp;= \mu_{3} + \epsilon_{43} \\
\end{cases}
\end{align*}.
\end{split}\]</div>
<p>Of course, you would usually have more than 4 subjects per-group, but this should make it very clear that all the ANOVA is doing is using the mean of each group as the predicted value. The magnitude of the errors within each group will then reflect how good a prediction the mean actually is.</p>
<p>Notice that there is nothing in the definition above that states how many values <span class="math notranslate nohighlight">\(j\)</span> should take. This is important because both the one-sample and two-sample <span class="math notranslate nohighlight">\(t\)</span>-tests are <em>sepecial cases</em> of the one-way ANOVA model given above. In the <em>one-sample</em> case, we set <span class="math notranslate nohighlight">\(j = 1\)</span> and we have</p>
<div class="math notranslate nohighlight">
\[
y_{i} = \mu + \epsilon_{i},
\]</div>
<p>which is about as simply as any linear model can get<a class="footnote-reference brackets" href="#j-foot" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. In the <em>two-sample</em> case, we set <span class="math notranslate nohighlight">\(j = 1,2\)</span> and we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    y_{i1} &amp;= \mu_{1} + \epsilon_{i1} \\
    y_{i2} &amp;= \mu_{2} + \epsilon_{i2},
\end{align*}
\end{split}\]</div>
<p>which is even more clearly a simplification of the one-way ANOVA. From a modelling perspective, there is therefore <em>no difference</em> between a <span class="math notranslate nohighlight">\(t\)</span>-test and an ANOVA. In fact, giving these two procedures different names is almost entirely unnecessary.</p>
<section id="connecting-dummy-variable-regression-to-the-linear-model">
<h3>Connecting Dummy Variable Regression to the Linear Model<a class="headerlink" href="#connecting-dummy-variable-regression-to-the-linear-model" title="Link to this heading">#</a></h3>
<p>Seeing that the two-sample <span class="math notranslate nohighlight">\(t\)</span>-test is equivalent to a simplified one-way ANOVA provides us a good opportunity to make a more explicit connection between the one-way ANOVA model</p>
<div class="math notranslate nohighlight">
\[
y_{ij} = \mu_{j} + \epsilon_{ij}
\]</div>
<p>and the simple regression model</p>
<div class="math notranslate nohighlight">
\[
y_{i} = \beta_{0} + \beta_{1}x_{i} + \epsilon_{i}.
\]</div>
<p>We know already that the dummy variable representation of the two-sample <span class="math notranslate nohighlight">\(t\)</span>-test creates <em>two</em> equations for the <em>two</em> different categories</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    E\left(y_{i1}\right) &amp;= \beta_{0} + \left(\beta_{1} \times 0\right) = \beta_{0} \\
    E\left(y_{i2}\right) &amp;= \beta_{0} + \left(\beta_{1} \times 1\right) = \beta_{0} + \beta_{1}
\end{align*}
\end{split}\]</div>
<p>In other words, every data point from the first category gets a predicted value of <span class="math notranslate nohighlight">\(\beta_{0}\)</span> and every data point from the second category gets a predicted value of <span class="math notranslate nohighlight">\(\beta_{0} + \beta_{1}\)</span>. Putting this in the context of group means, we also know that <span class="math notranslate nohighlight">\(\beta_{0} = \mu_{1}\)</span> and <span class="math notranslate nohighlight">\(\beta_{1} = \left(\mu_{2} - \mu_{1}\right)\)</span>. If we substitute these values in to the regression equations above, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    E\left(y_{i1}\right) &amp;= \mu_{1} \\
    E\left(y_{i2}\right) &amp;= \mu_{1} + \left(\mu_{2} - \mu_{1}\right) = \mu_{2}
\end{align*}
\end{split}\]</div>
<p>Putting it all together, we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_{i1} &amp;= \beta_{0} + \epsilon_{i1} \\ &amp;= \mu_{1} + \epsilon_{i1} \\
    y_{i2} &amp;= \beta_{0} + \beta_{1} + \epsilon_{i2} \\ &amp;= \mu_{2} + \epsilon_{i2}
\end{aligned}
\end{split}\]</div>
<p>As such, the dummy variable representation in the regression model simplifies to the traditional linear model specification. In other words, we can turn a regression model into a model of the group means through the use of dummy variables.</p>
</section>
</section>
<section id="dummy-variables-coding-2-levels">
<h2>Dummy Variables Coding &gt; 2 Levels<a class="headerlink" href="#dummy-variables-coding-2-levels" title="Link to this heading">#</a></h2>
<p>At this point, we should have a sense of the more formal linear model specification of a one-way ANOVA <em>and</em> should have a sense of how we can create this same model within the context of linear regression by using dummy variables. However, we have only seen this for cases where the categorical predictor has 2 levels. What happens when our our predictor has <em>more</em> than 2 levels?</p>
<p>The short answer is that we simply <em>add more dummy variables</em>. The general rule is that for <span class="math notranslate nohighlight">\(k\)</span> levels of a predictor we need to add <span class="math notranslate nohighlight">\(k - 1\)</span> dummy variables to the model. Notice that this fits with what we have already seen. For a two-sample <span class="math notranslate nohighlight">\(t\)</span>-test, <span class="math notranslate nohighlight">\(k = 2\)</span> and we had to add <span class="math notranslate nohighlight">\(2 - 1 = 1\)</span> dummy variable to the model. If it were a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test, we would have <span class="math notranslate nohighlight">\(k = 1\)</span> and we would add <span class="math notranslate nohighlight">\(1 - 1 = 0\)</span> dummy variables to the model (because we only need an intercept). For the most basic one-way ANOVA case where <span class="math notranslate nohighlight">\(k = 3\)</span>, we therefore need to add <span class="math notranslate nohighlight">\(3 - 1 = 2\)</span> dummy variables to the model.</p>
<section id="example-in-r">
<h3>Example in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#example-in-r" title="Link to this heading">#</a></h3>
<p>We will examine how this is done in <code class="docutils literal notranslate"><span class="pre">R</span></code> and then use this to discuss the theory in more detail. To begin with, we will redefine our <code class="docutils literal notranslate"><span class="pre">origin</span></code> variable to further split the <code class="docutils literal notranslate"><span class="pre">Other</span></code> category into <code class="docutils literal notranslate"><span class="pre">Japan</span></code> and <code class="docutils literal notranslate"><span class="pre">Europe</span></code>. We also convert this into a factor straight away and check the levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;Japan&#39;</span><span class="p">,</span><span class="s">&#39;Japan&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Japan&#39;</span><span class="p">,</span><span class="s">&#39;Japan&#39;</span><span class="p">,</span><span class="s">&#39;Japan&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span>
<span class="w">                   </span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;USA&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">,</span><span class="s">&#39;Europe&#39;</span><span class="p">)</span>
<span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Europe&quot; &quot;Japan&quot;  &quot;USA&quot;   
</pre></div>
</div>
</div>
</div>
<p>So we now have a categorical variable with <span class="math notranslate nohighlight">\(k = 3\)</span> levels and the dataset looks like this</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb origin
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4  Japan
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4  Japan
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1    USA
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1    USA
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2    USA
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1    USA
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4    USA
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2 Europe
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2 Europe
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4 Europe
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4 Europe
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3 Europe
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3 Europe
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3 Europe
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4    USA
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4    USA
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4    USA
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1 Europe
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2  Japan
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1  Japan
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1  Japan
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2    USA
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2    USA
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4    USA
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2    USA
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1 Europe
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2 Europe
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2 Europe
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4    USA
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6 Europe
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8 Europe
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2 Europe
</pre></div>
</div>
</div>
</div>
<p>Before modelling anything, let us now see how <code class="docutils literal notranslate"><span class="pre">R</span></code> has coded these catgories in terms of dummy variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">contrasts</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Japan USA
Europe     0   0
Japan      1   0
USA        0   1
</pre></div>
</div>
</div>
</div>
<p>So, now we have <em>two</em> dummy variables. The first (lablled <code class="docutils literal notranslate"><span class="pre">Japan</span></code>) is a 1 for all the Japanese cars and a 0 for everything else, whereas the second (labelled <code class="docutils literal notranslate"><span class="pre">USA</span></code>) is a 1 for all the USA cars and a 0 for everything else. Although we will not be using manually-defined dummy variables, it can be helpful to create these so you have the clearest sense of what is being put into the model. The code below shows the creation of these two dummy variables. Adding these to the model will results in an <em>identical</em> fit to the model we will use use a little further below<a class="footnote-reference brackets" href="#tryit-foot" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="w">         </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">)</span>
<span class="n">dummy.JAP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">dummy.USA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="n">dummy.JAP</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Japan&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">dummy.USA</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;USA&quot;</span><span class="p">]</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>

<span class="nf">print</span><span class="p">(</span><span class="n">dummy.JAP</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">dummy.USA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [1] 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0
 [1] 0 0 1 1 1 1 1 0 0 0 0 0 0 0 1 1 1 0 0 0 0 1 1 1 1 0 0 0 1 0 0 0
</pre></div>
</div>
</div>
</div>
<p>Including <em>two</em> dummy variables in the model will lead to <em>three</em> model parameters (intercept + two dummies), which we will call <span class="math notranslate nohighlight">\(\beta_{0}\)</span>, <span class="math notranslate nohighlight">\(\beta_{1}\)</span> and <span class="math notranslate nohighlight">\(\beta_{2}\)</span>. As we saw in previous examples, the intercept parameter <span class="math notranslate nohighlight">\(\beta_{0}\)</span> will become the <em>mean of the reference category</em>. In this example, this is whatever level is coded as a 0 across <em>both</em> dummy variables. The two slope parameters <span class="math notranslate nohighlight">\(\beta_{1}\)</span> and <span class="math notranslate nohighlight">\(\beta_{2}\)</span> will again become <em>mean differences</em> relative to the reference category. Without even fitting the model yet, we can therefore summise that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
    \mu_{\text{EUR}} &amp;= \beta_{0} + (\beta_{1} \times \mathbf{0}) + (\beta_{2} \times \mathbf{0}) = \beta_{0} \\
    \mu_{\text{JAP}}  &amp;= \beta_{0} + (\beta_{1} \times \mathbf{1}) + (\beta_{2} \times \mathbf{0}) = \beta_{0} + \beta_{1} \\
    \mu_{\text{USA}}    &amp;= \beta_{0} + (\beta_{1} \times \mathbf{0}) + (\beta_{2} \times \mathbf{1}) = \beta_{0} + \beta_{2} \\
\end{align*}
\end{split}\]</div>
<p>The dummy coding has been highlighted here in <strong>bold</strong> to make the clearest connection to the table of dummy values given by <code class="docutils literal notranslate"><span class="pre">R</span></code> earlier. Our interpretation of the parameters in this model is therefore</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_{0}\)</span></p></td>
<td><p>Mean of <code class="docutils literal notranslate"><span class="pre">Europe</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_{1}\)</span></p></td>
<td><p>Mean difference <code class="docutils literal notranslate"><span class="pre">Japan</span> <span class="pre">-</span> <span class="pre">Europe</span></code></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_{2}\)</span></p></td>
<td><p>Mean difference <code class="docutils literal notranslate"><span class="pre">USA</span> <span class="pre">-</span> <span class="pre">Europe</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Let us double-check our understanding by fitting this model and examing the output</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">origin.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">origin</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mtcars</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">origin.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = mpg ~ origin, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.8071 -4.1718 -0.7885  3.3444 10.5929 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   21.807      1.343  16.239 4.26e-16 ***
originJapan    3.753      2.618   1.434  0.16238    
originUSA     -5.669      1.935  -2.929  0.00656 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.025 on 29 degrees of freedom
Multiple R-squared:  0.3498,	Adjusted R-squared:  0.3049 
F-statistic:   7.8 on 2 and 29 DF,  p-value: 0.001947
</pre></div>
</div>
</div>
</div>
<p>Let us calculate the group means and differences manually and compare them with the model estimates</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mu.EUR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Europe&quot;</span><span class="p">])</span>
<span class="n">mu.JAP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Japan&quot;</span><span class="p">])</span>
<span class="n">mu.USA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">[</span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;USA&quot;</span><span class="p">])</span>

<span class="n">comp.table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;Means&quot;</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mu.EUR</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">mu.JAP</span><span class="o">-</span><span class="n">mu.EUR</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">mu.USA</span><span class="o">-</span><span class="n">mu.EUR</span><span class="p">)),</span>
<span class="w">                         </span><span class="s">&quot;Estimates&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">origin.mod</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">comp.table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                Means Estimates
(Intercept) 21.807143 21.807143
originJapan  3.752857  3.752857
originUSA   -5.668681 -5.668681
</pre></div>
</div>
</div>
</div>
<p>As we can see, the model fit is exactly as expected from our knowledge of the dummy variables. Furthermore, the automatic tests on the slope parameters are equivalent to performing <span class="math notranslate nohighlight">\(t\)</span>-tests on two of the possible mean differences across the levels of <code class="docutils literal notranslate"><span class="pre">origin</span></code>. On this basis, we could immediately draw some conclusions about the differences in MPG between these categories. For instance, if we want to use NHST for inference, we could say that there is a significant difference between the average MPG of USA cars and European cars (<span class="math notranslate nohighlight">\(t_{29} = -2.929, p &lt; 0.01\)</span>), but not between the average MPG of Japanese cars and European cars (<span class="math notranslate nohighlight">\(t_{29} = 1.434, p = 0.16\)</span>). What about comparing the USA and Japan? We could simply relevel the <code class="docutils literal notranslate"><span class="pre">origin</span></code> factor and change the reference in order to generate this test.</p>
<div class="note admonition">
<p class="admonition-title">Typical ANOVA Approach</p>
<p>An important element to recognise at present is that what we have demonstrated here is not the <em>typical</em> approach to an ANOVA. If you think of a more traditional ANOVA, it would be usual to generate an <em>omnibus</em> test of the factor as a whole and then consider <em>follow-up</em> tests after this. However, there is actually nothing wrong with just jumping straight to the tests on the parameter estimates. After all, this is what we always do in regression models. The insistance on an omnibus tests within an ANOVA framework is largely <em>historical</em> and a matter of <em>convention</em>, rather than mathematical necessity. Nevertheless, omnibus tests are useful because they group together parameter estimates that relate to the same variable. So, in a way, omnibus tests test the <em>higher-level structure</em> of the model, before we drill-down into the specifics. We will explore this more typical procedure and the nature of omnibus tests in the next part of this lesson.</p>
</div>
<p>Exploring the model results a little further, we can also see that the predicted values are simply the group means for each level of <code class="docutils literal notranslate"><span class="pre">origin</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="s">&quot;Predicted&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fitted</span><span class="p">(</span><span class="n">origin.mod</span><span class="p">),</span>
<span class="w">                 </span><span class="s">&quot;Origin&quot;</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">origin</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                    Predicted Origin
Mazda RX4            25.56000  Japan
Mazda RX4 Wag        25.56000  Japan
Datsun 710           16.13846    USA
Hornet 4 Drive       16.13846    USA
Hornet Sportabout    16.13846    USA
Valiant              16.13846    USA
Duster 360           16.13846    USA
Merc 240D            21.80714 Europe
Merc 230             21.80714 Europe
Merc 280             21.80714 Europe
Merc 280C            21.80714 Europe
Merc 450SE           21.80714 Europe
Merc 450SL           21.80714 Europe
Merc 450SLC          21.80714 Europe
Cadillac Fleetwood   16.13846    USA
Lincoln Continental  16.13846    USA
Chrysler Imperial    16.13846    USA
Fiat 128             21.80714 Europe
Honda Civic          25.56000  Japan
Toyota Corolla       25.56000  Japan
Toyota Corona        25.56000  Japan
Dodge Challenger     16.13846    USA
AMC Javelin          16.13846    USA
Camaro Z28           16.13846    USA
Pontiac Firebird     16.13846    USA
Fiat X1-9            21.80714 Europe
Porsche 914-2        21.80714 Europe
Lotus Europa         21.80714 Europe
Ford Pantera L       16.13846    USA
Ferrari Dino         21.80714 Europe
Maserati Bora        21.80714 Europe
Volvo 142E           21.80714 Europe
</pre></div>
</div>
</div>
</div>
<p>So, <span class="math notranslate nohighlight">\(\mu_{\text{EUR}} = 21.81\)</span>, <span class="math notranslate nohighlight">\(\mu_{\text{JAP}} = 25.56\)</span> and <span class="math notranslate nohighlight">\(\mu_{\text{USA}} = 16.14\)</span>. We can also recover these values by using the parameter estimates to replicate the model equations. In the code below, we write these in full with the dummy values to make it as clear as possible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">origin.mod</span><span class="p">)</span>

<span class="n">mu.EUR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="n">mu.JAP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="n">mu.USA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="n">means</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mu.EUR</span><span class="p">,</span><span class="w"> </span><span class="n">mu.JAP</span><span class="p">,</span><span class="w"> </span><span class="n">mu.USA</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">means</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;EUR&quot;</span><span class="p">,</span><span class="s">&quot;JAP&quot;</span><span class="p">,</span><span class="s">&quot;USA&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">means</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     EUR      JAP      USA 
21.80714 25.56000 16.13846 
</pre></div>
</div>
</div>
</div>
<p>We can also more easily do this using the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package, which is generally the approch we would advocate. For more complex models, it can become tricky to recover the group means by replicating the model equations, whereas the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package will always get this right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">effects</span><span class="p">)</span>
<span class="n">effs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">allEffects</span><span class="p">(</span><span class="n">origin.mod</span><span class="p">,</span><span class="w"> </span><span class="n">residuals</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">effs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> model: mpg ~ origin

 origin effect
origin
  Europe    Japan      USA 
21.80714 25.56000 16.13846 
</pre></div>
</div>
</div>
</div>
<p>The advantage of the <code class="docutils literal notranslate"><span class="pre">effects</span></code> package is that we can also produce a plot of the model fit</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">effs</span><span class="p">,</span><span class="w"> </span><span class="n">partial.residuals</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">smooth</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">40</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/5d93ba1543534cdcd38c82e8c2ee5bd4e81d800acf104f5b237b288ccbab9f27.png"><img alt="_images/5d93ba1543534cdcd38c82e8c2ee5bd4e81d800acf104f5b237b288ccbab9f27.png" src="_images/5d93ba1543534cdcd38c82e8c2ee5bd4e81d800acf104f5b237b288ccbab9f27.png" style="width: 420px; height: 420px;" /></a>
</div>
</div>
<p>Here we can see the large overlap in CIs between <code class="docutils literal notranslate"><span class="pre">Europe</span></code> and <code class="docutils literal notranslate"><span class="pre">Japan</span></code>, which is why this difference is not “significant”. We can also clearly see how much lower the MPG values are for cars from the <code class="docutils literal notranslate"><span class="pre">USA</span></code>. This plot is also interesting because we can see that there is quite a wide-range of MPGs within the <code class="docutils literal notranslate"><span class="pre">Europe</span></code> category, as well as an apparent dichotomisation of cars within the <code class="docutils literal notranslate"><span class="pre">Japan</span></code> category. This is likely because we have mixed together low-MPG sports cars with high-MPG non-sports cars within those groups. This suggests that an additional categorical variable denoting the <em>type</em> of car could be useful in explaining the variance in the data.</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="j-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Here, we have removed <span class="math notranslate nohighlight">\(j\)</span> because it is constant across all the model equations and thus has become redundant.</p>
</aside>
<aside class="footnote brackets" id="tryit-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>We will leave it as an exercise if you want to validate this for yourself. Remember, the only difference between doing this manually and letting <code class="docutils literal notranslate"><span class="pre">R</span></code> do it automatically is whether other functions inside <code class="docutils literal notranslate"><span class="pre">R</span></code> “know” that the two dummy variable actually represent a single categorical variable. Without this knowledge, everything else inside <code class="docutils literal notranslate"><span class="pre">R</span></code> will treat them as two separate binary variables.</p>
</aside>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-way-anova-as-a-linear-model">One-way ANOVA as a Linear Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connecting-dummy-variable-regression-to-the-linear-model">Connecting Dummy Variable Regression to the Linear Model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dummy-variables-coding-2-levels">Dummy Variables Coding &gt; 2 Levels</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-in-r">Example in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar & Dr George Farmer
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025-26.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>